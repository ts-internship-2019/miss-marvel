
@model IEnumerable<iWasHere.Domain.DTOs.DictionaryCityModel>



@{
    ViewData["Title"] = "Ditctionar Orase";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



<!DOCTYPE html>



<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Cities</title>
</head>
<body>
    <p>
        <a asp-action="AddEditCity">Create New</a>
    </p>
 
    <div class="row">
        @(Html.Kendo().TextBox()
           .Name("custom")
           .HtmlAttributes(new { style = "width: 50%", title = "custom", id = "txtFilter" })
        )
        @(Html.Kendo().Button()
                        .Name("btnSubmit")
                        .HtmlAttributes(new { type = "button" })
                        .Content("Filter")
                        .Events(e => e.Click("DisplayData"))
        )
       </div>
    <div>
        <td>
            <label for="countiesCB">Nume Judet:</label>
        </td>
        <td>
            @(Html.Kendo().ComboBox()
             .Name("countiesCB")
             .Placeholder("Judet..")
             .DataTextField("CountyName")
             .DataValueField("CountyId")
             .HtmlAttributes(new { style = "width:100%;" })
             .Filter(FilterType.Contains)
             .AutoBind(false)
             .MinLength(3)
             .DataSource(source =>
             {
                 source.Read(read =>
                 {
                     read.Action("GetComboCounty", "Dictionary");
                 })
                 .ServerFiltering(true);
             })
            )
        </td>
        <td>
            @(Html.Kendo().Button()
                .Name("clearFilter")
                .Icon("clear-filter")
                .Content("Sterge Filtru")
                .HtmlAttributes(new { type = "button" })
                .Events(e => e.Click("delFilters"))
                )
        </td>
    </div>
    @(Html.Kendo().Grid<iWasHere.Domain.DTOs.DictionaryCityModel>()
          .Name("grid")
          .HtmlAttributes(new { style = "height: 500px", id = "grdCities" })
          .Columns(columns =>
          {
              columns.Bound(p => p.CityId).Hidden();
              columns.Bound(p => p.CityName);
              columns.Bound(p => p.CityCode);
              columns.Command(c =>
              {
                  c.Custom("EditRecord").Text("Edit").Click("dgChange");
                  c.Custom("Delete").Text("Detele").Click("gridDelete");

              });
          })
          .Scrollable()
          // .Groupable()
          .Sortable()
          .Filterable()
          .Pageable(pageable => pageable
            .Refresh(true)
            .PageSizes(true)
            .ButtonCount(5))
          .DataSource(dataSource => dataSource
              .Ajax()
              .Read(read => read.Action("GetCities", "Dictionary").Data("myFunction"))
              .Update(update => update.Action("AddEditCity", "Grid"))
          )
    )





</body>
<script>



    function DisplayData() {
        $("#grdCities").data("kendoGrid").dataSource.read()




        
    }
    function dgChange(e) {
      
        var row = e.currentTarget.closest("tr").cells[0].outerText;

         grid = $("#grdCities").data("kendoGrid");
        var row = e.currentTarget.closest("tr").cells[0].outerText;
        window.location = '/Dictionary/AddEditCity?id=' + row


    }

        function deleteRowLang(id) {
            $.ajax({
                type: 'DELETE',
                url: '@Url.Action("DeleteLanguage", "DictionaryLanguage")',
                data: { id: id },
                success: function (response) {
                    alert("hai ca merge");
                    alert(id);
                    $("#languageGrid").data("kendoGrid").dataSource.read();
                },
                error: function (response) {
                    alert("hai ca nu merge");
                }
            }

    function delFilters() {
        $("#txtFilter").val(null);
        $("#countiesCB").data("kendoComboBox").value("");
        $('#grdCities').data("kendoGrid").dataSource.read();
        $('#grdCities').data("kendoGrid").dataSource.page(1);
    }

    function myFunction() {
        var filter = $("#txtFilter").val();
        var countyFilter = $("#countiesCB").val();
        var obj = {};
        obj["lFilter"] = filter;
        obj["text"] = countyFilter;
        return obj;
    }

    
</script>
</html>